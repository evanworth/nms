
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>NMS School Day Block Tracker v2</title>
  <link rel="manifest" href="/nms/manifest.json">
  <meta name="theme-color" content="#003366" />
 <style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    text-align: center;
    padding: 20px;
    background-color: #f4f6f8;
    color: #222;
    margin: 0;
  }
  h1 {
    color: #003366;
    margin-top: 10px;
    font-size: 1.8em;
  }
  .clock {
    font-size: 2.2em;
    background: #000;
    color: #00ff88;
    padding: 10px 25px;
    border-radius: 10px;
    display: inline-block;
    margin: 20px 0;
    font-family: 'Courier New', monospace;
  }
  .period-box {
    background: #e3f2fd;
    padding: 25px;
    border-radius: 18px;
    box-shadow: 0 3px 6px rgba(0,0,0,0.15);
    max-width: 420px;
    margin: 0 auto;
    transition: all 0.3s ease;
  }
  .period-box.active {
    background-color: #003366;
    color: #fff;
    transform: scale(1.05);
    box-shadow: 0 0 25px rgba(0, 51, 102, 0.6);
    animation: pulse 2s infinite;
  }
  @keyframes pulse {
    0% { box-shadow: 0 0 15px rgba(0, 51, 102, 0.6); }
    50% { box-shadow: 0 0 35px rgba(0, 51, 102, 0.8); }
    100% { box-shadow: 0 0 15px rgba(0, 51, 102, 0.6); }
  }
  .label {
    font-size: 1.2em;
    margin: 10px 0;
  }
  #currentPeriod {
    font-size: 2em;
    font-weight: 800;
    margin: 15px 0;
    text-transform: uppercase;
  }
  .time-left {
    font-size: 1.2em;
    font-weight: 500;
    color: #00ffcc;
  }
  .next-period {
    margin-top: 8px;
    font-size: 1.1em;
    color: #ffd54f;
  }
  .lunch-box {
    margin-top: 25px;
    background: #fff3cd;
    padding: 15px;
    border-radius: 10px;
    display: inline-block;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
  }
  .schedule-box {
    margin-top: 25px;
    padding: 15px;
    background: #fff;
    border-radius: 10px;
    max-width: 400px;
    margin-left: auto;
    margin-right: auto;
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);
  }
  footer {
    margin-top: 30px;
    font-size: 0.9em;
    color: #666;
  }
</style>
</head>
<body>
  <img src="icon-192.png" alt="NMS Logo" width="400" style="margin-top:10px;">
  <h1>Nissitissit Middle School Period Tracker</h1>
  <div class="clock" id="clock"></div>
  <div class="period-box" id="periodBox">
    <div class="label" id="dayType"></div>
    <div class="label" id="currentPeriod"></div>
    <div class="time-left" id="timeRemaining"></div>
    <div class="next-period" id="nextPeriod"></div>
  </div>

  <div class="lunch-box">
    <h3>Lunch Schedule</h3>
    <p>Grade 5: 10:50 - 11:20</p>
    <p>Grade 6: 11:22 - 11:52</p>
    <p>Grade 7: 11:54 - 12:24</p>
    <p>Grade 8: 12:26 - 12:56</p>
  </div>

  <div class="schedule-box" id="fullSchedule"></div>

  <footer>Patriot Pride Starts With You · Nissitissit Middle School</footer>

  <script>
    const schedules = {
      mw: [
        ["1", "08:10", "08:40"],
        ["2", "08:40", "09:30"],
        ["3", "09:30", "10:20"],
        ["4", "10:20", "11:10"],
        ["5", "11:10", "12:00"],
        ["6", "12:00", "12:50"],
        ["7", "12:50", "13:40"],
        ["8", "13:40", "14:25"]
      ],
      ttf: [
        ["1", "08:05", "09:00"],
        ["2", "09:00", "09:55"],
        ["3", "09:55", "10:50"],
        ["4", "10:50", "11:45"],
        ["5", "11:45", "12:40"],
        ["6", "12:40", "13:35"],
        ["7", "13:35", "14:25"]
      ]
    };

    function updateClock() {
      const now = new Date();
      const hours = now.getHours().toString().padStart(2, '0');
      const mins = now.getMinutes().toString().padStart(2, '0');
      const secs = now.getSeconds().toString().padStart(2, '0');
      document.getElementById('clock').textContent = `${hours}:${mins}:${secs}`;

      const day = now.getDay();
      if (day === 0 || day === 6) {
        document.getElementById('dayType').textContent = "Weekend Schedule";
        document.getElementById('currentPeriod').textContent = "It's the weekend — no school today!";
        document.getElementById('timeRemaining').textContent = "";
        document.getElementById('nextPeriod').textContent = "";
        document.getElementById('periodBox').classList.remove('active');
        document.getElementById('fullSchedule').innerHTML = "";
        return;
      }

      const isMW = (day === 1 || day === 3);
      const todaySchedule = isMW ? schedules.mw : schedules.ttf;
      document.getElementById('dayType').textContent =
        isMW ? "Monday/Wednesday Schedule" : "Tuesday/Thursday/Friday Schedule";

      const currentTime = now.getHours() * 60 + now.getMinutes();
      let period = "No school right now";
      let timeLeft = "";
      let nextPeriodText = "";
      let active = false;

      for (let i = 0; i < todaySchedule.length; i++) {
        const [p, start, end] = todaySchedule[i];
        const [sh, sm] = start.split(':').map(Number);
        const [eh, em] = end.split(':').map(Number);
        const startMins = sh * 60 + sm;
        const endMins = eh * 60 + em;

        if (currentTime >= startMins && currentTime < endMins) {
          period = `Current Period: ${p}`;
          const secsLeft = (endMins - currentTime) * 60 - now.getSeconds();
          const minsLeft = Math.floor(secsLeft / 60);
          const secLeft = secsLeft % 60;
          timeLeft = `${minsLeft}:${secLeft.toString().padStart(2,'0')} left in this period.`;
          active = true;
          if (i + 1 < todaySchedule.length) {
            const [np] = todaySchedule[i + 1];
            nextPeriodText = `Next Period: ${np} starts at ${todaySchedule[i + 1][1]}`;
          }
          break;
        } else if (currentTime < startMins) {
          period = `Passing Time`;
          const minsUntil = startMins - currentTime;
          nextPeriodText = `Next Period: ${p} starts in ${minsUntil} min.`;
          break;
        }
      }

      const box = document.getElementById('periodBox');
      box.classList.toggle('active', active);
      document.getElementById('currentPeriod').textContent = period;
      document.getElementById('timeRemaining').textContent = timeLeft;
      document.getElementById('nextPeriod').textContent = nextPeriodText;

      document.getElementById('fullSchedule').innerHTML =
        todaySchedule.map(([p, s, e]) => `<p>Period ${p}: ${s} - ${e}</p>`).join('');
    }

    setInterval(updateClock, 1000);
    updateClock();

    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('/nms/service-worker.js')
        .then(() => console.log('Service worker registered'))
        .catch(err => console.log('SW registration failed:', err));
    }
  </script>
</body>
</html>
